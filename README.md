# AIé…éŸ³ç³»ç»Ÿ v1.1.0

åŸºäºKimi/GPTå’ŒAzure TTSçš„æ™ºèƒ½SRTå­—å¹•ç¿»è¯‘ä¸è¯­éŸ³åˆæˆç³»ç»Ÿï¼Œå®ç°é«˜ç²¾åº¦æ—¶é—´åŒæ­¥çš„å¤šè¯­è¨€é…éŸ³ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒæ¨¡å—
```
ai-srt-dubbing-master/
â”œâ”€â”€ translation/          # æ™ºèƒ½ç¿»è¯‘å¼•æ“
â”œâ”€â”€ audio_processor/      # éŸ³é¢‘å¤„ç†ä¸åˆ†æ®µ
â”œâ”€â”€ timing/              # æ—¶é—´åŒæ­¥ç®¡ç†
â”œâ”€â”€ tts/                 # è¯­éŸ³åˆæˆå¼•æ“
â”œâ”€â”€ ui/                  # Streamlitç•Œé¢
â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
```

### æ•°æ®æµæ¶æ„
```
SRTå­—å¹• â†’ æ™ºèƒ½åˆ†æ®µ â†’ å¹¶å‘ç¿»è¯‘ â†’ æ–‡æœ¬ä¼˜åŒ– â†’ TTSåˆæˆ â†’ æ—¶é—´åŒæ­¥ â†’ éŸ³é¢‘ç¡®è®¤ â†’ æœ€ç»ˆè¾“å‡º
```

## ğŸ“Š æ ¸å¿ƒæ•°æ®ç»“æ„

### SegmentDTO - ç»Ÿä¸€ç‰‡æ®µæ¨¡å‹
```python
@dataclass
class SegmentDTO:
    # åŸºç¡€ä¿¡æ¯
    id: str                    # ç‰‡æ®µå”¯ä¸€æ ‡è¯†
    start: float              # å¼€å§‹æ—¶é—´ï¼ˆç§’ï¼‰
    end: float                # ç»“æŸæ—¶é—´ï¼ˆç§’ï¼‰
    
    # å¤šé˜¶æ®µæ–‡æœ¬å¤„ç†
    original_text: str        # åŸå§‹å­—å¹•æ–‡æœ¬
    translated_text: str      # ç¬¬ä¸€è½®ç¿»è¯‘ç»“æœ
    optimized_text: str       # ç®—æ³•ä¼˜åŒ–åæ–‡æœ¬
    final_text: str          # æœ€ç»ˆTTSä½¿ç”¨æ–‡æœ¬
    
    # æ—¶é—´ä¸éŸ³é¢‘
    target_duration: float    # ç›®æ ‡æ—¶é•¿
    actual_duration: float    # å®é™…éŸ³é¢‘æ—¶é•¿
    speech_rate: float        # è¯­é€Ÿå€ç‡
    
    # è´¨é‡è¯„ä¼°
    quality: str             # è´¨é‡è¯„çº§
    timing_error_ms: float   # æ—¶é•¿è¯¯å·®
    sync_ratio: float        # åŒæ­¥æ¯”ä¾‹
```

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### 1. æ™ºèƒ½ç¿»è¯‘å¼•æ“
- **åŒAPIæ”¯æŒ**: Kimi K2-0711-preview + OpenAI GPT-4
- **å¤šç‰ˆæœ¬ç­–ç•¥**: minimal/compact/standard/detailed
- **ç²¾ç¡®é•¿åº¦æ§åˆ¶**: å­—ç¬¦æ•°ç²¾ç¡®åŒ¹é…ç›®æ ‡æ—¶é•¿
- **å¹¶å‘ä¼˜åŒ–**: æ”¯æŒ50å¹¶å‘ï¼Œ200 RPMé™åˆ¶

```python
# ç¿»è¯‘é…ç½®ç¤ºä¾‹
translation:
  model: "kimi-k2-0711-preview"
  use_kimi: true
  max_concurrent_batches: 5
  multi_version_prompts:
    minimal: {length_factor: 0.60}
    compact: {length_factor: 0.75}
    standard: {length_factor: 1.0}
    detailed: {length_factor: 1.30}
```

### 2. ç²¾ç¡®TTSæ§åˆ¶
- **Azure TTSåŒå¯†é’¥**: æ•…éšœåˆ‡æ¢æœºåˆ¶
- **å¾ªç¯é€¼è¿‘ç®—æ³•**: ç²¾ç¡®è¯­é€Ÿæ§åˆ¶
- **åŠ¨æ€æ ¡å‡†**: å®æ—¶ä¼˜åŒ–ä¼°ç®—ç²¾åº¦
- **é«˜ä¿çœŸè¾“å‡º**: 48kHzéŸ³é¢‘è´¨é‡

```python
# TTSä¼˜åŒ–æµç¨‹
1. ä¼°ç®—ç›®æ ‡è¯­é€Ÿ â†’ 2. ç”ŸæˆéŸ³é¢‘ â†’ 3. è®¡ç®—è¯¯å·® â†’ 4. è°ƒæ•´è¯­é€Ÿ â†’ 5. é‡æ–°ç”Ÿæˆ
```

### 3. æ—¶é—´åŒæ­¥ç®—æ³•
- **æ™ºèƒ½åˆ†æ®µ**: ä¿æŒå¥å­å®Œæ•´æ€§
- **é‡å å¤„ç†**: è‡ªç„¶è¯­éŸ³è¿‡æ¸¡
- **è¯¯å·®å®¹å¿**: 20%åŒæ­¥å®¹å¿åº¦
- **è¿­ä»£ä¼˜åŒ–**: æœ€å¤§5è½®ä¼˜åŒ–

### 4. æ¨¡å—åŒ–UIæ¶æ„
- **å·¥ä½œæµç®¡ç†**: WorkflowManagerç»Ÿä¸€åè°ƒ
- **ç»„ä»¶åŒ–è®¾è®¡**: å„é˜¶æ®µç‹¬ç«‹ç»„ä»¶
- **å®æ—¶é¢„è§ˆ**: éŸ³é¢‘ç¡®è®¤ç•Œé¢
- **è´¨é‡è¯„ä¼°**: æ™ºèƒ½å»ºè®®ç³»ç»Ÿ

## âš™ï¸ é…ç½®ç®¡ç†

### æ ¸å¿ƒé…ç½®é¡¹
```yaml
# APIé…ç½®
api_keys:
  kimi_api_key: "sk-..."
  azure_speech_key_1: "..."
  azure_speech_key_2: "..."

# ç¿»è¯‘é…ç½®
translation:
  use_kimi: true
  max_concurrent_batches: 5
  max_tokens: 8000

# TTSé…ç½®
tts:
  speech_rate: 1.0
  voices:
    en: "en-US-AndrewMultilingualNeural"
    es: "es-MX-JorgeNeural"

# æ—¶é—´åŒæ­¥
timing:
  sync_tolerance: 0.20
  max_iterations: 5
  max_speed_ratio: 1.15
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**: Python 3.8+
- **UIæ¡†æ¶**: Streamlit
- **AIæœåŠ¡**: Kimi K2, OpenAI GPT-4
- **TTSæœåŠ¡**: Azure Speech Services
- **éŸ³é¢‘å¤„ç†**: Pydub
- **å¹¶å‘æ§åˆ¶**: ThreadPoolExecutor
- **é…ç½®ç®¡ç†**: PyYAML

## ğŸ“ˆ æ€§èƒ½ç‰¹æ€§

### å¹¶å‘å¤„ç†
- ç¿»è¯‘å¹¶å‘: 50è¯·æ±‚/åˆ†é’Ÿ
- TTSå¹¶å‘: 8è¯·æ±‚/åˆ†é’Ÿ
- ç¼“å­˜å‘½ä¸­: æ™ºèƒ½é‡å¤æ£€æµ‹

### ç²¾åº¦æ§åˆ¶
- æ—¶é•¿è¯¯å·®: <100ms
- å­—ç¬¦åŒ¹é…: Â±8å­—ç¬¦å®¹å·®
- åŒæ­¥æ¯”ä¾‹: 0.95-1.15èŒƒå›´

### æˆæœ¬ä¼˜åŒ–
- Tokenç»Ÿè®¡: å®æ—¶ä½¿ç”¨é‡ç›‘æ§
- ç¼“å­˜æœºåˆ¶: é¿å…é‡å¤ç¿»è¯‘
- é™çº§ç­–ç•¥: APIæ•…éšœè‡ªåŠ¨åˆ‡æ¢

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
```bash
Python 3.8+
pip install -r requirements.txt
```

### é…ç½®è®¾ç½®
1. å¤åˆ¶`config.yaml`å¹¶å¡«å…¥APIå¯†é’¥
2. é…ç½®ç›®æ ‡è¯­è¨€å’Œè¯­éŸ³å‚æ•°
3. è°ƒæ•´å¹¶å‘å’Œé¢‘ç‡é™åˆ¶

### å¯åŠ¨åº”ç”¨
```bash
streamlit run ui/streamlit_app_refactored.py
```

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼
- ä¸­æ–‡æ³¨é‡Šï¼Œè‹±æ–‡å‡½æ•°å
- ç±»å‹æç¤º: `from typing import`
- æ¨¡å—åŒ–è®¾è®¡ï¼Œå•ä¸€èŒè´£
- å¼‚å¸¸å¤„ç†å’Œé™çº§æ–¹æ¡ˆ

### APIä¼˜åŒ–åŸåˆ™
- ä¼˜å…ˆè€ƒè™‘tokenæ•ˆç‡
- æ”¯æŒåŒAPIåˆ‡æ¢
- å¹¶å‘æ§åˆ¶å’Œå»¶è¿Ÿç®¡ç†
- ç¼“å­˜å’Œç»Ÿè®¡ç›‘æ§

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. å‘èµ·Pull Request

---

**ç‰ˆæœ¬**: 1.1.0  
**æ›´æ–°æ—¥æœŸ**: 2024-12-19  
**ç»´æŠ¤è€…**: AIé…éŸ³ç³»ç»Ÿå›¢é˜Ÿ 